<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Expense_Flow.Views.Reports.ReportsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <!-- Compact -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="16"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[0].Width" Value="*"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[1].Width" Value="0"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[2].Width" Value="0"/>
                        <Setter Target="Card1.(Grid.Column)" Value="0"/>
                        <Setter Target="Card1.(Grid.Row)" Value="0"/>
                        <Setter Target="Card2.(Grid.Column)" Value="0"/>
                        <Setter Target="Card2.(Grid.Row)" Value="1"/>
                        <Setter Target="Card3.(Grid.Column)" Value="0"/>
                        <Setter Target="Card3.(Grid.Row)" Value="2"/>
                        <Setter Target="SummaryGrid.RowSpacing" Value="12"/>
                        <Setter Target="ConfigGrid.ColumnDefinitions[0].Width" Value="*"/>
                        <Setter Target="ConfigGrid.ColumnDefinitions[1].Width" Value="0"/>
                        <Setter Target="GenerateButton.(Grid.Column)" Value="0"/>
                        <Setter Target="GenerateButton.(Grid.Row)" Value="1"/>
                        <Setter Target="ConfigGrid.RowSpacing" Value="12"/>
                    </VisualState.Setters>
                </VisualState>
                
                <!-- Medium -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="24"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[0].Width" Value="*"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[1].Width" Value="*"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[2].Width" Value="0"/>
                        <Setter Target="Card1.(Grid.Column)" Value="0"/>
                        <Setter Target="Card1.(Grid.Row)" Value="0"/>
                        <Setter Target="Card2.(Grid.Column)" Value="1"/>
                        <Setter Target="Card2.(Grid.Row)" Value="0"/>
                        <Setter Target="Card3.(Grid.Column)" Value="0"/>
                        <Setter Target="Card3.(Grid.Row)" Value="1"/>
                        <Setter Target="SummaryGrid.RowSpacing" Value="16"/>
                        <Setter Target="ConfigGrid.ColumnDefinitions[0].Width" Value="*"/>
                        <Setter Target="ConfigGrid.ColumnDefinitions[1].Width" Value="Auto"/>
                        <Setter Target="GenerateButton.(Grid.Column)" Value="1"/>
                        <Setter Target="GenerateButton.(Grid.Row)" Value="0"/>
                        <Setter Target="ConfigGrid.RowSpacing" Value="0"/>
                    </VisualState.Setters>
                </VisualState>
                
                <!-- Large -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1007" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="32,24,32,32"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[0].Width" Value="*"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[1].Width" Value="*"/>
                        <Setter Target="SummaryGrid.ColumnDefinitions[2].Width" Value="*"/>
                        <Setter Target="Card1.(Grid.Column)" Value="0"/>
                        <Setter Target="Card1.(Grid.Row)" Value="0"/>
                        <Setter Target="Card2.(Grid.Column)" Value="1"/>
                        <Setter Target="Card2.(Grid.Row)" Value="0"/>
                        <Setter Target="Card3.(Grid.Column)" Value="2"/>
                        <Setter Target="Card3.(Grid.Row)" Value="0"/>
                        <Setter Target="SummaryGrid.RowSpacing" Value="0"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Spacing="8">
                <TextBlock Text="Reports" 
                         Style="{StaticResource PageTitleTextStyle}"/>
                <TextBlock Text="Analyze your spending patterns and generate insights"
                         Style="{StaticResource BodyTextBlockStyle}"
                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                         TextWrapping="Wrap"/>
            </StackPanel>

            <Button Grid.Column="1"
                  Content="Export Report" 
                  Style="{StaticResource PrimaryButtonStyle}"
                  VerticalAlignment="Center"
                  Click="ExportReport_Click">
                <Button.KeyboardAccelerators>
                    <KeyboardAccelerator Key="E" Modifiers="Control"/>
                </Button.KeyboardAccelerators>
            </Button>
        </Grid>

        <!-- Report Configuration -->
        <Border Grid.Row="1"
              Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
              CornerRadius="12"
              Padding="16"
              Margin="0,0,0,16"
              Translation="0,0,8">
            <Grid x:Name="ConfigGrid" ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ComboBox Grid.Column="0" Grid.Row="0"
                        x:Name="ReportTypeComboBox"
                        PlaceholderText="Select Report Type"
                        SelectedIndex="0"
                        SelectionChanged="ReportType_SelectionChanged"
                        HorizontalAlignment="Stretch"
                        Style="{StaticResource ModernComboBoxStyle}">
                    <ComboBoxItem Content="Overall Summary" Tag="Overall"/>
                    <ComboBoxItem Content="By Project" Tag="ByProject"/>
                    <ComboBoxItem Content="By Project Group" Tag="ByProjectGroup"/>
                    <ComboBoxItem Content="By Payment Mode" Tag="ByPaymentMode"/>
                    <ComboBoxItem Content="By Contact" Tag="ByContact"/>
                </ComboBox>

                <Button x:Name="GenerateButton"
                      Grid.Column="1" Grid.Row="0"
                      Content="Generate Report"
                      Click="GenerateReport_Click"
                      Style="{StaticResource PrimaryButtonStyle}"/>
            </Grid>
        </Border>

        <!-- Summary Cards -->
        <Grid x:Name="SummaryGrid" Grid.Row="2" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnSpacing>16</Grid.ColumnSpacing>
            <Grid.RowSpacing>0</Grid.RowSpacing>

            <!-- Total Amount Card -->
            <Border x:Name="Card1"
                  Grid.Column="0" Grid.Row="0"
                  Background="{StaticResource PrimaryGradientBrush}"
                  Style="{StaticResource GradientCardStyle}"
                  Translation="0,0,16">
                <StackPanel Spacing="8">
                    <TextBlock Text="Total Amount"
                             Foreground="White"
                             Style="{StaticResource StatLabelTextStyle}"
                             Opacity="0.9"/>
                    <TextBlock x:Name="TotalAmountText"
                             Foreground="White"
                             FontSize="32"
                             FontWeight="Bold"
                             Text="$0.00"/>
                </StackPanel>
            </Border>

            <!-- Transaction Count Card -->
            <Border x:Name="Card2"
                  Grid.Column="1" Grid.Row="0"
                  Background="{StaticResource SuccessGradientBrush}"
                  Style="{StaticResource GradientCardStyle}"
                  Translation="0,0,16">
                <StackPanel Spacing="8">
                    <TextBlock Text="Transactions"
                             Foreground="White"
                             Style="{StaticResource StatLabelTextStyle}"
                             Opacity="0.9"/>
                    <TextBlock x:Name="TransactionCountText"
                             Foreground="White"
                             FontSize="32"
                             FontWeight="Bold"
                             Text="0"/>
                </StackPanel>
            </Border>

            <!-- Average Amount Card -->
            <Border x:Name="Card3"
                  Grid.Column="2" Grid.Row="0"
                  Background="{StaticResource WarningGradientBrush}"
                  Style="{StaticResource GradientCardStyle}"
                  Translation="0,0,16">
                <StackPanel Spacing="8">
                    <TextBlock Text="Average"
                             Foreground="White"
                             Style="{StaticResource StatLabelTextStyle}"
                             Opacity="0.9"/>
                    <TextBlock x:Name="AverageAmountText"
                             Foreground="White"
                             FontSize="32"
                             FontWeight="Bold"
                             Text="$0.00"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Report Content -->
        <Grid Grid.Row="3">
            <!-- Loading Indicator -->
            <ProgressRing x:Name="LoadingRing"
                        IsActive="False"
                        Width="50" Height="50"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Visibility="Collapsed"/>

            <!-- Empty State -->
            <Border x:Name="EmptyState"
                  Style="{StaticResource StatCardStyle}"
                  Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
                  Translation="0,0,16">
                <StackPanel Spacing="20" Padding="48">
                    <Border Background="{StaticResource PurpleGradientBrush}"
                          Width="80" Height="80"
                          CornerRadius="40"
                          HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE9D9;" 
                                FontSize="40" 
                                Foreground="White"/>
                    </Border>
                    <TextBlock Text="No report data"
                             Style="{StaticResource SectionTitleTextStyle}"
                             HorizontalAlignment="Center"/>
                    <TextBlock Text="Select a report type and click 'Generate Report' to view data"
                             Style="{StaticResource BodyTextBlockStyle}"
                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                             HorizontalAlignment="Center"
                             TextWrapping="Wrap"
                             TextAlignment="Center"
                             MaxWidth="400"/>
                    <Button Content="Generate Report"
                          Style="{StaticResource PrimaryButtonStyle}"
                          HorizontalAlignment="Center"
                          Click="GenerateReport_Click"/>
                </StackPanel>
            </Border>

            <!-- Report Data List -->
            <ScrollViewer x:Name="ReportDataScroller" Visibility="Collapsed">
                <Border Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
                      Style="{StaticResource StatCardStyle}"
                      Translation="0,0,16">
                    <StackPanel Spacing="16">
                        <TextBlock Text="Report Data"
                                 Style="{StaticResource SectionTitleTextStyle}"/>
                        
                        <ItemsRepeater x:Name="ReportDataRepeater">
                            <ItemsRepeater.Layout>
                                <StackLayout Spacing="8"/>
                            </ItemsRepeater.Layout>
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                          CornerRadius="8"
                                          Padding="16">
                                        <Grid ColumnSpacing="16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0"
                                                     Text="Category"
                                                     Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                            <TextBlock Grid.Column="1"
                                                     Text="$0.00"
                                                     Style="{StaticResource BodyStrongTextBlockStyle}"
                                                     Foreground="{StaticResource PrimaryBrush}"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>
                    </StackPanel>
                </Border>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>