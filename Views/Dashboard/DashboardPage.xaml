<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Expense_Flow.Views.Dashboard.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:Expense_Flow.Models"
    xmlns:controls="using:Expense_Flow.Controls"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- Define visual state triggers at Page level -->
    </Page.Resources>
    
    <Grid x:Name="RootGrid">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <!-- Compact State for narrow windows -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="16"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[1].Width" Value="0"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[2].Width" Value="0"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[3].Width" Value="0"/>
                        <Setter Target="Card2.(Grid.Column)" Value="0"/>
                        <Setter Target="Card2.(Grid.Row)" Value="1"/>
                        <Setter Target="Card3.(Grid.Column)" Value="0"/>
                        <Setter Target="Card3.(Grid.Row)" Value="2"/>
                        <Setter Target="Card4.(Grid.Column)" Value="0"/>
                        <Setter Target="Card4.(Grid.Row)" Value="3"/>
                        <Setter Target="StatsGrid.RowSpacing" Value="12"/>
                        <Setter Target="ContentGrid.ColumnDefinitions[1].Width" Value="0"/>
                        <Setter Target="QuickActionsCard.(Grid.Column)" Value="0"/>
                        <Setter Target="QuickActionsCard.(Grid.Row)" Value="1"/>
                        <Setter Target="ContentGrid.RowSpacing" Value="20"/>
                    </VisualState.Setters>
                </VisualState>
                
                <!-- Medium State for tablet -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="640" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="24"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[1].Width" Value="*"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[2].Width" Value="0"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[3].Width" Value="0"/>
                        <Setter Target="Card2.(Grid.Column)" Value="1"/>
                        <Setter Target="Card2.(Grid.Row)" Value="0"/>
                        <Setter Target="Card3.(Grid.Column)" Value="0"/>
                        <Setter Target="Card3.(Grid.Row)" Value="1"/>
                        <Setter Target="Card4.(Grid.Column)" Value="1"/>
                        <Setter Target="Card4.(Grid.Row)" Value="1"/>
                        <Setter Target="StatsGrid.RowSpacing" Value="16"/>
                        <Setter Target="ContentGrid.ColumnDefinitions[1].Width" Value="0"/>
                        <Setter Target="QuickActionsCard.(Grid.Column)" Value="0"/>
                        <Setter Target="QuickActionsCard.(Grid.Row)" Value="1"/>
                        <Setter Target="ContentGrid.RowSpacing" Value="20"/>
                    </VisualState.Setters>
                </VisualState>
                
                <!-- Large State for desktop -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1007" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Padding" Value="32,24,32,32"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[1].Width" Value="*"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[2].Width" Value="*"/>
                        <Setter Target="StatsGrid.ColumnDefinitions[3].Width" Value="*"/>
                        <Setter Target="Card2.(Grid.Column)" Value="1"/>
                        <Setter Target="Card2.(Grid.Row)" Value="0"/>
                        <Setter Target="Card3.(Grid.Column)" Value="2"/>
                        <Setter Target="Card3.(Grid.Row)" Value="0"/>
                        <Setter Target="Card4.(Grid.Column)" Value="3"/>
                        <Setter Target="Card4.(Grid.Row)" Value="0"/>
                        <Setter Target="StatsGrid.RowSpacing" Value="0"/>
                        <Setter Target="ContentGrid.ColumnDefinitions[1].Width" Value="*"/>
                        <Setter Target="QuickActionsCard.(Grid.Column)" Value="1"/>
                        <Setter Target="QuickActionsCard.(Grid.Row)" Value="0"/>
                        <Setter Target="ContentGrid.RowSpacing" Value="0"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        
        <ScrollViewer>
            <Grid Padding="32,24,32,32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header Section -->
                <Grid Grid.Row="0" Margin="0,0,0,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Spacing="8">
                        <TextBlock Text="Dashboard" 
                                Style="{StaticResource PageTitleTextStyle}"/>
                        <TextBlock Text="Welcome back! Here's your financial overview."
                                Style="{StaticResource BodyTextBlockStyle}"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                TextWrapping="Wrap"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" 
                                Orientation="Horizontal" 
                                Spacing="12"
                                VerticalAlignment="Center">
                        <ComboBox x:Name="DateRangeComboBox"
                                  PlaceholderText="Select period"
                                  MinWidth="180"
                                  SelectedIndex="2"
                                  SelectionChanged="DateRangeComboBox_SelectionChanged"
                                  Style="{StaticResource ModernComboBoxStyle}">
                            <ComboBoxItem Content="Current Month" Tag="CurrentMonth"/>
                            <ComboBoxItem Content="Previous Month" Tag="PreviousMonth"/>
                            <ComboBoxItem Content="Last 30 Days" Tag="Last30Days"/>
                            <ComboBoxItem Content="Last 2 Months" Tag="Last2Months"/>
                            <ComboBoxItem Content="Last 3 Months" Tag="Last3Months"/>
                            <ComboBoxItem Content="Last 1 Year" Tag="Last1Year"/>
                        </ComboBox>
                        <Button Style="{StaticResource IconButtonStyle}"
                                ToolTipService.ToolTip="Refresh"
                                Click="RefreshButton_Click">
                            <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Stat Cards with Responsive Grid -->
                <Grid x:Name="StatsGrid" Grid.Row="1" Margin="0,0,0,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnSpacing>16</Grid.ColumnSpacing>
                    <Grid.RowSpacing>0</Grid.RowSpacing>

                    <!-- Card 1: Total Expenses -->
                    <Border x:Name="Card1" 
                            Grid.Column="0" Grid.Row="0"
                            Background="{StaticResource PrimaryGradientBrush}"
                            Style="{StaticResource GradientCardStyle}"
                            Translation="0,0,32">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <TextBlock Text="Total Expenses" 
                                        Foreground="White"
                                        Style="{StaticResource StatLabelTextStyle}"
                                        Opacity="0.9"/>
                                <Border Background="#40FFFFFF" 
                                        CornerRadius="12"
                                        Padding="8,4"
                                        HorizontalAlignment="Right">
                                    <FontIcon Glyph="&#xE8C7;" 
                                            FontSize="16" 
                                            Foreground="White"/>
                                </Border>
                            </Grid>

                            <TextBlock Grid.Row="1"
                                    Text="{x:Bind ViewModel.TotalExpenses, Mode=OneWay}"
                                    Foreground="White"
                                    FontSize="36"
                                    FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    Margin="0,16,0,16"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE74A;" 
                                        FontSize="12" 
                                        Foreground="#90FFFFFF"/>
                                <TextBlock Text="{x:Bind ViewModel.TotalExpensesChange, Mode=OneWay}" 
                                        Foreground="#90FFFFFF"
                                        FontSize="11"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Card 2: Active Projects -->
                    <Border x:Name="Card2" 
                            Grid.Column="1" Grid.Row="0"
                            Background="{StaticResource SuccessGradientBrush}"
                            Style="{StaticResource GradientCardStyle}"
                            Translation="0,0,32">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <TextBlock Text="Active Projects" 
                                        Foreground="White"
                                        Style="{StaticResource StatLabelTextStyle}"
                                        Opacity="0.9"/>
                                <Border Background="#40FFFFFF" 
                                        CornerRadius="12"
                                        Padding="8,4"
                                        HorizontalAlignment="Right">
                                    <FontIcon Glyph="&#xE8F1;" 
                                            FontSize="16" 
                                            Foreground="White"/>
                                </Border>
                            </Grid>

                            <TextBlock Grid.Row="1"
                                    Text="{x:Bind ViewModel.ActiveProjectsCount, Mode=OneWay}"
                                    Foreground="White"
                                    FontSize="36"
                                    FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    Margin="0,16,0,16"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE73E;" 
                                        FontSize="12" 
                                        Foreground="#90FFFFFF"/>
                                <TextBlock Text="{x:Bind ViewModel.NewProjectsThisWeek, Mode=OneWay}" 
                                        Foreground="#90FFFFFF"
                                        FontSize="11"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Card 3: This Month -->
                    <Border x:Name="Card3" 
                            Grid.Column="2" Grid.Row="0"
                            Background="{StaticResource WarningGradientBrush}"
                            Style="{StaticResource GradientCardStyle}"
                            Translation="0,0,32">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <TextBlock Text="{x:Bind ViewModel.SelectedPeriodLabel, Mode=OneWay}" 
                                        Foreground="White"
                                        Style="{StaticResource StatLabelTextStyle}"
                                        Opacity="0.9"/>
                                <Border Background="#40FFFFFF" 
                                        CornerRadius="12"
                                        Padding="8,4"
                                        HorizontalAlignment="Right">
                                    <FontIcon Glyph="&#xE787;" 
                                            FontSize="16" 
                                            Foreground="White"/>
                                </Border>
                            </Grid>

                            <TextBlock Grid.Row="1"
                                    Text="{x:Bind ViewModel.ThisMonthExpenses, Mode=OneWay}"
                                    Foreground="White"
                                    FontSize="36"
                                    FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    Margin="0,16,0,16"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE738;" 
                                        FontSize="12" 
                                        Foreground="#90FFFFFF"/>
                                <TextBlock Text="{x:Bind ViewModel.ThisMonthTransactions, Mode=OneWay}" 
                                        Foreground="#90FFFFFF"
                                        FontSize="11"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Card 4: Budget Used -->
                    <Border x:Name="Card4" 
                            Grid.Column="3" Grid.Row="0"
                            Background="{StaticResource PurpleGradientBrush}"
                            Style="{StaticResource GradientCardStyle}"
                            Translation="0,0,32">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <TextBlock Text="Budget Used" 
                                        Foreground="White"
                                        Style="{StaticResource StatLabelTextStyle}"
                                        Opacity="0.9"/>
                                <Border Background="#40FFFFFF" 
                                        CornerRadius="12"
                                        Padding="8,4"
                                        HorizontalAlignment="Right">
                                    <FontIcon Glyph="&#xE9D9;" 
                                            FontSize="16" 
                                            Foreground="White"/>
                                </Border>
                            </Grid>

                            <StackPanel Grid.Row="1" 
                                        VerticalAlignment="Center"
                                        Spacing="8"
                                        Margin="0,16,0,16">
                                <TextBlock Text="{x:Bind ViewModel.BudgetUsedPercentage, Mode=OneWay, Converter={StaticResource StringFormatConverter}, ConverterParameter='{}{0:F1}%'}"
                                        Foreground="White"
                                        FontSize="36"
                                        FontWeight="Bold"/>
                                <ProgressBar Value="{x:Bind ViewModel.BudgetUsedPercentage, Mode=OneWay}" 
                                            Maximum="100"
                                            Foreground="White"
                                            Background="#40FFFFFF"
                                            CornerRadius="4"/>
                            </StackPanel>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xE7C3;" 
                                        FontSize="12" 
                                        Foreground="#90FFFFFF"/>
                                <TextBlock Text="{x:Bind ViewModel.BudgetRemaining, Mode=OneWay}" 
                                        Foreground="#90FFFFFF"
                                        FontSize="11"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Content Area with Responsive Grid -->
                <Grid x:Name="ContentGrid" Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnSpacing>20</Grid.ColumnSpacing>
                    <Grid.RowSpacing>0</Grid.RowSpacing>

                    <!-- Recent Expenses Card -->
                    <Border x:Name="RecentExpensesCard" 
                            Grid.Column="0" Grid.Row="0"
                            Style="{StaticResource StatCardStyle}"
                            Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
                            Translation="0,0,16">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <TextBlock Text="Recent Expenses" 
                                        Style="{StaticResource SectionTitleTextStyle}"/>
                                <Button Content="View All" 
                                        HorizontalAlignment="Right"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Click="ViewAllExpenses_Click"/>
                            </Grid>

                            <!-- Expense List - Visible when there are expenses -->
                            <ScrollViewer Grid.Row="1"
                                        x:Name="ExpenseListScroller"
                                        Visibility="Collapsed"
                                        MaxHeight="400">
                                <ItemsRepeater ItemsSource="{x:Bind ViewModel.RecentExpenses, Mode=OneWay}">
                                    <ItemsRepeater.Layout>
                                        <StackLayout Spacing="8"/>
                                    </ItemsRepeater.Layout>
                                    <ItemsRepeater.ItemTemplate>
                                        <DataTemplate x:DataType="models:Expense">
                                            <controls:ExpenseCard Expense="{x:Bind}"
                                                                IsCompact="True"
                                                                Click="ExpenseCard_Click"/>
                                        </DataTemplate>
                                    </ItemsRepeater.ItemTemplate>
                                </ItemsRepeater>
                            </ScrollViewer>

                            <!-- Empty State - Visible when no expenses -->
                            <StackPanel Grid.Row="1"
                                        x:Name="ExpenseEmptyState"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Spacing="16"
                                        Visibility="Visible">
                                <FontIcon Glyph="&#xE8C7;" 
                                        FontSize="64"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Opacity="0.3"/>
                                <TextBlock Text="No recent expenses"
                                         Style="{StaticResource SubtitleTextBlockStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <Button Content="Add Your First Expense"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Click="AddExpense_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Quick Actions Card -->
                    <Border x:Name="QuickActionsCard" 
                            Grid.Column="1" Grid.Row="0"
                            Style="{StaticResource StatCardStyle}"
                            Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
                            Translation="0,0,16">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Quick Actions" 
                                     Style="{StaticResource SectionTitleTextStyle}"/>

                            <Button HorizontalAlignment="Stretch"
                                    Height="60"
                                    Click="AddExpense_Click">
                                <Button.Resources>
                                    <ResourceDictionary>
                                        <ResourceDictionary.ThemeDictionaries>
                                            <ResourceDictionary x:Key="Light">
                                                <AcrylicBrush x:Key="ButtonBackground"
                                                            TintColor="{StaticResource PrimaryColor}"
                                                            TintOpacity="0.1"
                                                            FallbackColor="{StaticResource PrimaryColor}"/>
                                            </ResourceDictionary>
                                            <ResourceDictionary x:Key="Dark">
                                                <AcrylicBrush x:Key="ButtonBackground"
                                                            TintColor="{StaticResource PrimaryColor}"
                                                            TintOpacity="0.2"
                                                            FallbackColor="{StaticResource PrimaryColor}"/>
                                            </ResourceDictionary>
                                        </ResourceDictionary.ThemeDictionaries>
                                    </ResourceDictionary>
                                </Button.Resources>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" 
                                            Glyph="&#xE710;" 
                                            FontSize="24"
                                            Foreground="{StaticResource PrimaryBrush}"
                                            Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" 
                                             Text="Add Expense"
                                             VerticalAlignment="Center"
                                             Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                </Grid>
                            </Button>

                            <Button HorizontalAlignment="Stretch"
                                    Height="60"
                                    Click="NewProject_Click">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" 
                                            Glyph="&#xE8F1;" 
                                            FontSize="24"
                                            Foreground="{StaticResource SuccessBrush}"
                                            Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" 
                                             Text="New Project"
                                             VerticalAlignment="Center"
                                             Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                </Grid>
                            </Button>

                            <Button HorizontalAlignment="Stretch"
                                    Height="60"
                                    Click="ViewReports_Click">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" 
                                            Glyph="&#xE9D9;" 
                                            FontSize="24"
                                            Foreground="{StaticResource WarningBrush}"
                                            Margin="0,0,12,0"/>
                                    <TextBlock Grid.Column="1" 
                                             Text="View Reports"
                                             VerticalAlignment="Center"
                                             Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                </Grid>
                            </Button>

                            <Rectangle Fill="{ThemeResource DividerStrokeColorDefaultBrush}"
                                     Height="1"
                                     Margin="0,8"/>

                            <!-- Top Projects -->
                            <TextBlock Text="Top Projects" 
                                     Style="{StaticResource BodyStrongTextBlockStyle}"
                                     Margin="0,8,0,8"/>

                            <ItemsRepeater ItemsSource="{x:Bind ViewModel.TopProjects, Mode=OneWay}">
                                <ItemsRepeater.Layout>
                                    <StackLayout Spacing="8"/>
                                </ItemsRepeater.Layout>
                                <ItemsRepeater.ItemTemplate>
                                    <DataTemplate x:DataType="models:Project">
                                        <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                                CornerRadius="8"
                                                Padding="12">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0"
                                                        Background="{StaticResource PurpleBrush}"
                                                        Width="32" Height="32"
                                                        CornerRadius="8"
                                                        Margin="0,0,12,0">
                                                    <FontIcon Glyph="&#xE8F1;" 
                                                            Foreground="White"
                                                            FontSize="14"/>
                                                </Border>

                                                <StackPanel Grid.Column="1" 
                                                            VerticalAlignment="Center">
                                                    <TextBlock Text="{x:Bind Name}"
                                                             Style="{StaticResource CaptionTextBlockStyle}"
                                                             FontWeight="SemiBold"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsRepeater.ItemTemplate>
                            </ItemsRepeater>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>